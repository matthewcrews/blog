<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>The Mentor Matching Problem - Matthew Crews</title><meta name=Description content="Hugo theme - LoveIt"><meta property="og:title" content="The Mentor Matching Problem">
<meta property="og:description" content="There are few things I love more than a fresh mathematical planning challenge so I was delighted when Kevin Avignon reached out to me and asked me to look at a question he had posted on the Software Engineer Stack Exchange site. He wanted to know whether the question was a candidate for Mathematical Planning. The question is a really interesting problem of pairing Mentors and Mentees. Mentors have a set of skills they can teach."><meta property="og:type" content="article"><meta property="og:url" content="https://matthewcrews.com/blog/2020/12/2020-12-03/"><meta property="og:image" content="https://matthewcrews.com/logo.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-12-03T00:00:00+00:00"><meta property="article:modified_time" content="2023-12-17T00:23:58-08:00"><meta property="og:site_name" content="Matthew Crews"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://matthewcrews.com/logo.png"><meta name=twitter:title content="The Mentor Matching Problem"><meta name=twitter:description content="There are few things I love more than a fresh mathematical planning challenge so I was delighted when Kevin Avignon reached out to me and asked me to look at a question he had posted on the Software Engineer Stack Exchange site. He wanted to know whether the question was a candidate for Mathematical Planning. The question is a really interesting problem of pairing Mentors and Mentees. Mentors have a set of skills they can teach."><meta name=twitter:site content="@xxxx"><meta name=application-name content="Mathew Crews"><meta name=apple-mobile-web-app-title content="Mathew Crews"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://matthewcrews.com/blog/2020/12/2020-12-03/><link rel=prev href=https://matthewcrews.com/blog/2020/12/2020-12-01/><link rel=next href=https://matthewcrews.com/blog/2020/12/2020-12-04/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"The Mentor Matching Problem","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/matthewcrews.com\/blog\/2020\/12\/2020-12-03\/"},"image":[{"@type":"ImageObject","url":"https:\/\/matthewcrews.com\/images\/Apple-Devices-Preview.png","width":3200,"height":2048}],"genre":"blog","wordcount":1523,"url":"https:\/\/matthewcrews.com\/blog\/2020\/12\/2020-12-03\/","datePublished":"2020-12-03T00:00:00+00:00","dateModified":"2023-12-17T00:23:58-08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/matthewcrews.com\/images\/fast_fsharp_avatar.png"},"author":{"@type":"Person","name":"Matthew Crews"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Matthew Crews">Matthew Crews</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/blog/>Blog </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/matthewcrews/blog title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Matthew Crews">Matthew Crews</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/blog/ title>Blog</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/matthewcrews/blog title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">The Mentor Matching Problem</h1><div class=content id=content><p>There are few things I love more than a fresh mathematical planning challenge so I was delighted when <a href=https://twitter.com/KAvignon target=_blank rel="noopener noreffer">Kevin Avignon</a> reached out to me and asked me to look at a question he had posted on the Software Engineer Stack Exchange site. He wanted to know whether the question was a candidate for Mathematical Planning. <a href=https://softwareengineering.stackexchange.com/questions/418268/mentorship-schedule-matchmaking-algorithm target=_blank rel="noopener noreffer">The question</a> is a really interesting problem of pairing Mentors and Mentees. Mentors have a set of skills they can teach. Mentees have a set of skills they are interested in learning. Both Mentors and Mentees only have certain times they are available. Mentors are also capable of mentoring multiple mentees.</p><p>So, for this sounds like a straightforward assignment problem but then there is a twist. The questioner wanted pairings of rare skills to be a higher priority than pairings of more common skills. Ah, now we have a Mathematical Planning problem! We have the three key ingredients:</p><ol><li>A Quantifiable Objective: We want to maximize the value of pairings based on the rarity of the skill</li><li>Constraints to follow: Mentors and Mentees must match on skills and availability</li><li>Decision to make: Which Mentors and Mentees do we pair at what time?</li></ol><p>Any time I see those three ingredients, I know I have a Mathematical Planning problem on my hands. I respond to Kevin and say, &ldquo;Yes! You have a great candidate for Mathematical Planning! I&rsquo;ll put something together for you this evening.&rdquo; I begin mulling this problem as the day goes by. Once the family is all in bed, I turn on my PC and start modeling!</p><h2 id=define-the-domain>Define the Domain</h2><p>The first thing I do is put together a tiny domain of types to represent my problem. I encourage anyone who is writing these models in F# to take advantage of domain modeling because it will protect you again some nefarious bugs. To learn more, check out Scott Wlaschin&rsquo;s book <a href=https://fsharpforfunandprofit.com/books/ target=_blank rel="noopener noreffer">Domain Modeling Made Functional</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>namespace</span> <span class=n>MentorMatching</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>module</span> <span class=nn>Types</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>type</span> <span class=nc>MentorId</span> <span class=o>=</span> <span class=n>MentorId</span> <span class=k>of</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=k>type</span> <span class=nc>MenteeId</span> <span class=o>=</span> <span class=n>MenteeId</span> <span class=k>of</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=k>type</span> <span class=nc>Skill</span> <span class=o>=</span> <span class=n>Skill</span> <span class=k>of</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=k>type</span> <span class=nc>Period</span> <span class=o>=</span> <span class=n>Period</span> <span class=k>of</span> <span class=n>int</span>
</span></span><span class=line><span class=cl>    <span class=k>type</span> <span class=nc>MenteeCapacity</span> <span class=o>=</span> <span class=n>MenteeCapacity</span> <span class=k>of</span> <span class=n>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>type</span> <span class=nc>Mentor</span> <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>MentorId</span> <span class=o>:</span> <span class=n>MentorId</span>
</span></span><span class=line><span class=cl>        <span class=n>Skills</span> <span class=o>:</span> <span class=n>Skill</span> <span class=n>Set</span>
</span></span><span class=line><span class=cl>        <span class=n>Periods</span> <span class=o>:</span> <span class=n>Period</span> <span class=n>Set</span>
</span></span><span class=line><span class=cl>        <span class=n>MaxMentees</span> <span class=o>:</span> <span class=n>MenteeCapacity</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>type</span> <span class=nc>Mentee</span> <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>MenteeId</span> <span class=o>:</span> <span class=n>MenteeId</span>
</span></span><span class=line><span class=cl>        <span class=n>Skills</span> <span class=o>:</span> <span class=n>Skill</span> <span class=n>Set</span>
</span></span><span class=line><span class=cl>        <span class=n>Periods</span> <span class=o>:</span> <span class=n>Period</span> <span class=n>Set</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>This simple set of types represent the problem space that I will build a mathematical planning model around. I now want to create a function which builds the model. I like to type out the functions signatures of what I am trying to implement beforehand as a way to get a high-level overview for that I am about to build. It&rsquo;s an idea I got from <a href=https://blog.ploeh.dk/ target=_blank rel="noopener noreffer">Mark Seemann</a> in his excellent PluralSight course <a href=https://app.pluralsight.com/library/courses/fsharp-type-driven-development/table-of-contents target=_blank rel="noopener noreffer">Type-Driven Development with F#</a>. Here is the function signature that I come to.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>private</span> <span class=n>buildModel</span> <span class=o>(</span><span class=n>mentees</span><span class=o>:</span><span class=n>Mentee</span> <span class=n>seq</span><span class=o>)</span> <span class=o>(</span><span class=n>mentors</span><span class=o>:</span><span class=n>Mentor</span> <span class=n>seq</span><span class=o>)</span> <span class=o>(</span><span class=n>skillValue</span><span class=o>:</span><span class=n>SMap</span><span class=o>&lt;</span><span class=n>Skill</span><span class=o>,</span><span class=kt>float</span><span class=o>&gt;)</span> <span class=o>(</span><span class=n>pairingDecision</span><span class=o>:</span><span class=n>SMap4</span><span class=o>&lt;</span><span class=n>Skill</span><span class=o>,</span><span class=n>Period</span><span class=o>,</span><span class=n>Mentor</span><span class=o>,</span><span class=n>Mentee</span><span class=o>,</span><span class=n>Decision</span><span class=o>&gt;)</span> <span class=o>:</span> <span class=n>Model</span> <span class=o>=</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>mentees</code> and <code>mentors</code> arguments are self-explanatory. They are the mentors and mentees we want to pair up. The <code>skillValue</code> argument is the value we have assigned to each <code>Skill</code> for this problem. I will discuss the heuristic we use to calculate the value for a skill in a following section. The <code>pairingDecision</code> argument is a 4-dimensional <a href=http://matthewcrews.com/SliceMap/#/ target=_blank rel="noopener noreffer">SliceMap</a>. The first dimension is the <code>Skill</code>, the second dimension is the <code>Period</code>, the third dimension is the <code>Mentor</code>, and the final dimension is the <code>Mentee</code>. The value in the SliceMap is a <code>Boolean</code> decision which indicates whether to use the pairing or not. We will be taking advantage of the slicing capabilities of SliceMaps to make the formulation more streamlined.</p><p>The first thing we need to do is create a set of constraints which state that a given <code>Mentee</code> may only be assigned once. We use a <code>ConstraintBuilder</code> Computation Expression and iterate through the <code>mentees</code>, creating a constraint for each <code>mentee</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>menteeSingleAssignmentConstraints</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=n>ConstraintBuilder</span> <span class=s>&#34;MenteeSingleAssignment&#34;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>mentee</span> <span class=k>in</span> <span class=n>mentees</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>            <span class=n>sum</span> <span class=n>pairingDecision</span><span class=o>[</span><span class=n>All</span><span class=o>,</span> <span class=n>All</span><span class=o>,</span> <span class=n>All</span><span class=o>,</span> <span class=n>mentee</span><span class=o>]</span> <span class=o>&lt;==</span> <span class=n>1</span><span class=o>.</span><span class=n>0</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now we need to limit how many Mentees a Mentor can take on. This value is the <code>MenteeCapacity</code> of the <code>Mentor</code>. We will loop through the sequence of Mentors and create the constraints that we need.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>mentorMaxAssignmentConstraints</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=n>ConstraintBuilder</span> <span class=s>&#34;MentorMaxAssignments&#34;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>mentor</span> <span class=k>in</span> <span class=n>mentors</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>            <span class=k>let</span> <span class=o>(</span><span class=n>MenteeCapacity</span> <span class=n>menteeCapacity</span><span class=o>)</span> <span class=o>=</span> <span class=n>mentor</span><span class=o>.</span><span class=n>MaxMentees</span>
</span></span><span class=line><span class=cl>            <span class=n>sum</span> <span class=n>pairingDecision</span><span class=o>[</span><span class=n>All</span><span class=o>,</span> <span class=n>All</span><span class=o>,</span> <span class=n>mentor</span><span class=o>,</span> <span class=n>All</span><span class=o>]</span> <span class=o>&lt;==</span> <span class=kt>float</span> <span class=n>menteeCapacity</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>There is an important nuance to this problem that could easily be missed. Mentors can take on multiple Mentees. It is entirely possible that the same Mentor is mentoring two different Mentees at the same time. This does not make sense. We need to create a set of constraints which prevents this from happening. We will create a constraint for each Mentor and each period to ensure this is not the case.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>mentorSingleAssignmentForPeriodConstraints</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=n>ConstraintBuilder</span> <span class=s>&#34;MentorSingleAssignmentForPeriod&#34;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>mentor</span> <span class=k>in</span> <span class=n>mentors</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>period</span> <span class=k>in</span> <span class=n>mentor</span><span class=o>.</span><span class=n>Periods</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>                <span class=k>let</span> <span class=nv>x</span> <span class=o>=</span> <span class=n>pairingDecision</span><span class=o>[</span><span class=n>All</span><span class=o>,</span> <span class=n>period</span><span class=o>,</span> <span class=n>mentor</span><span class=o>,</span> <span class=n>All</span><span class=o>]</span>
</span></span><span class=line><span class=cl>                <span class=n>sum</span> <span class=n>pairingDecision</span><span class=o>[</span><span class=n>All</span><span class=o>,</span> <span class=n>period</span><span class=o>,</span> <span class=n>mentor</span><span class=o>,</span> <span class=n>All</span><span class=o>]</span> <span class=o>&lt;==</span> <span class=n>1</span><span class=o>.</span><span class=n>0</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>That is all the constraints that we need but we still need to create an expression that quantifies success, our objective function. We have assigned a value to each <code>Skill</code>. We want to award pairings of valuable skills. To do that we can multiply the <code>Value</code> of the <code>Skill</code> by the decision that corresponds to that skill. The <code>SliceMap</code> library provides a couple of conveniences for expressing this. The <code>sum</code> function and the <code>.*</code> operator. The <code>sum</code> function is a function meant to be used with SliceMaps to make translating from math notation to code more straightforward. It is not strictly necessary, but it does make this kind of work more straightforward. The <code>.*</code> operator is known as the <a href=https://en.wikipedia.org/wiki/Hadamard_product_%28matrices%29 target=_blank rel="noopener noreffer">Hadamard Product</a>. If you have worked in Matlab, you probably recognize it. It is an element by element multiplication along matching dimensions. In this case it is going to multiply the value associated with each <code>Skill</code> by the pairing decision that it corresponds to.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl> <span class=k>let</span> <span class=nv>assignmentValueExpr</span> <span class=o>=</span> <span class=n>sum</span> <span class=o>(</span><span class=n>skillValue</span> <span class=o>.*</span> <span class=n>pairingDecision</span><span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>assignmentValueExpr</code> is a mathematical expression which quantifies how good of a solution the Solver has found. This is the thing we are wanting the Solver to make as large as possible. From here we create an <code>Objective</code> and compose our model.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>maxAssignmentValueObjecitve</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=nn>Objective</span><span class=p>.</span><span class=n>create</span> <span class=s>&#34;MaxAssignmentValue&#34;</span> <span class=n>Maximize</span> <span class=n>assignmentValueExpr</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>model</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=nn>Model</span><span class=p>.</span><span class=n>create</span> <span class=n>maxAssignmentValueObjecitve</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Model</span><span class=p>.</span><span class=n>addConstraints</span> <span class=n>menteeSingleAssignmentConstraints</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Model</span><span class=p>.</span><span class=n>addConstraints</span> <span class=n>mentorMaxAssignmentConstraints</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Model</span><span class=p>.</span><span class=n>addConstraints</span> <span class=n>mentorSingleAssignmentForPeriodConstraints</span>
</span></span></code></pre></td></tr></table></div></div><p>From here we can call the <code>Solver.solve</code> function and get our results.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>solveSettings</span> <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SolverType</span> <span class=o>=</span> <span class=n>CBC</span>
</span></span><span class=line><span class=cl>    <span class=n>MaxDuration</span> <span class=o>=</span> <span class=n>1_000L</span>
</span></span><span class=line><span class=cl>    <span class=n>WriteLPFile</span> <span class=o>=</span> <span class=n>None</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>result</span> <span class=o>=</span> <span class=nn>Solver</span><span class=p>.</span><span class=n>solve</span> <span class=n>solveSettings</span> <span class=n>model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>match</span> <span class=n>result</span> <span class=k>with</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>Optimal</span> <span class=n>sln</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nn>Solution</span><span class=p>.</span><span class=n>getValues</span> <span class=n>sln</span> <span class=o>(</span><span class=n>pairingDecision</span><span class=o>.</span><span class=n>AsMap</span><span class=bp>()</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Map</span><span class=p>.</span><span class=n>toSeq</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>filter</span> <span class=o>(</span><span class=k>fun</span> <span class=o>(</span><span class=n>k</span><span class=o>,</span> <span class=n>v</span><span class=o>)</span> <span class=o>-&gt;</span> <span class=n>v</span> <span class=o>&gt;=</span> <span class=n>1</span><span class=o>.</span><span class=n>0</span><span class=o>)</span> <span class=c1>// Get the Pairings that the solver selected
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>map</span> <span class=n>fst</span> <span class=c1>// Return just the tuple representing the pairing
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>|&gt;</span> <span class=nn>Result</span><span class=p>.</span><span class=n>Ok</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=o>_</span> <span class=o>-&gt;</span> <span class=nn>Result</span><span class=p>.</span><span class=n>Error</span> <span class=s>&#34;Error Solving
</span></span></span></code></pre></td></tr></table></div></div><p>If you want to see the full solution, check out <a href=https://github.com/matthewcrews/MentorMatching target=_blank rel="noopener noreffer">the repo</a> where I put it together.</p><h2 id=quantifying-the-value-of-a-skill>Quantifying the Value of a Skill</h2><p>Earlier I mentioned that I would talk about the heuristic that was used to evaluate the value of a skill. I propose that we just rank the skills by the frequency of their occurrence and assign value based on its rank.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>private</span> <span class=n>getSkillValue</span> <span class=o>(</span><span class=n>mentees</span><span class=o>:</span><span class=n>Mentee</span> <span class=n>seq</span><span class=o>)</span> <span class=o>(</span><span class=n>mentors</span><span class=o>:</span><span class=n>Mentor</span> <span class=n>seq</span><span class=o>)</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nv>menteeSkills</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>mentees</span>
</span></span><span class=line><span class=cl>        <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>collect</span> <span class=o>(</span><span class=k>fun</span> <span class=n>m</span> <span class=o>-&gt;</span> <span class=n>m</span><span class=o>.</span><span class=n>Skills</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nv>mentorSkills</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>mentors</span>
</span></span><span class=line><span class=cl>        <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>collect</span> <span class=o>(</span><span class=k>fun</span> <span class=n>m</span> <span class=o>-&gt;</span> <span class=n>m</span><span class=o>.</span><span class=n>Skills</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nv>skillCounts</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=nn>Seq</span><span class=p>.</span><span class=n>append</span> <span class=n>menteeSkills</span> <span class=n>mentorSkills</span>
</span></span><span class=line><span class=cl>        <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>countBy</span> <span class=n>id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nv>numberOfSkills</span> <span class=o>=</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>length</span> <span class=n>skillCounts</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>skillCounts</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>sortBy</span> <span class=n>snd</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>mapi</span> <span class=o>(</span><span class=k>fun</span> <span class=n>i</span> <span class=o>(</span><span class=n>skill</span><span class=o>,</span> <span class=o>_)</span> <span class=o>-&gt;</span> <span class=n>skill</span><span class=o>,</span> <span class=kt>float</span> <span class=o>(</span><span class=n>numberOfSkills</span> <span class=o>-</span> <span class=n>i</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Map</span><span class=p>.</span><span class=n>ofSeq</span>
</span></span></code></pre></td></tr></table></div></div><p>This ranking and scoring will ensure that the solver will choose low frequency skills over high frequency skills. There are some bizarre edge cases that could crop up, but I don&rsquo;t have the space to cover them here.</p><h2 id=why-mathematical-planning-instead-some-other-algorithm>Why Mathematical Planning instead some other algorithm?</h2><p>While this was a fun challenge, it is important to step back and ask, &ldquo;Why would I choose this technique over some other?&rdquo; The question on Stack Exchange has an interesting discussion of different approaches people proposed. Each of them has their own merit. The reason that I often propose Mathematical Planning that it is easy to modify should the nature of the problem change. If some new constraint was required, it would be relatively easy to refactor the code and add it. Bespoke implementations of heuristics are often difficult to refactor and evolve over time.</p><p>This was a fun challenge and I hope it ends up being useful. If you have questions about whether your problem is a good candidate for Mathematical Planning, please reach out!</p></div><div id=comments></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.121.1">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=matthewcrews.com target=_blank>Matthew Crews</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"PASDMWALPK",algoliaIndex:"index.en",algoliaSearchKey:"b42948e51daaa93df92381c8e2ac0f93",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>