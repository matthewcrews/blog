<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Maximizing Profitability of Inventory with Mathematical Planning and Machine Learning in F# - Part 1 - Matthew Crews</title><meta name=Description content="Hugo theme - LoveIt"><meta property="og:title" content="Maximizing Profitability of Inventory with Mathematical Planning and Machine Learning in F# - Part 1"><meta property="og:description" content="One of the questions that I love to answer is, &ldquo;What is the difference between Mathematical Planning and Machine Learning?&rdquo; This is an excellent question. The fields are close to one another and solutions often involve both techniques. The way I differentiate is based on what question they are meant to answer. Mathematical Planning is primarily concerned with answering the question, &ldquo;What should we do?&rdquo; Machine Learning answers the question, &ldquo;What is most likely?"><meta property="og:type" content="article"><meta property="og:url" content="https://matthewcrews.com/blog/2020/12/2020-12-14/"><meta property="og:image" content="https://matthewcrews.com/logo.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-12-14T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-23T09:34:35-07:00"><meta property="og:site_name" content="Matthew Crews"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://matthewcrews.com/logo.png"><meta name=twitter:title content="Maximizing Profitability of Inventory with Mathematical Planning and Machine Learning in F# - Part 1"><meta name=twitter:description content="One of the questions that I love to answer is, &ldquo;What is the difference between Mathematical Planning and Machine Learning?&rdquo; This is an excellent question. The fields are close to one another and solutions often involve both techniques. The way I differentiate is based on what question they are meant to answer. Mathematical Planning is primarily concerned with answering the question, &ldquo;What should we do?&rdquo; Machine Learning answers the question, &ldquo;What is most likely?"><meta name=application-name content="Mathew Crews"><meta name=apple-mobile-web-app-title content="Mathew Crews"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://matthewcrews.com/blog/2020/12/2020-12-14/><link rel=prev href=https://matthewcrews.com/blog/2020/12/2020-12-09/><link rel=next href=https://matthewcrews.com/blog/2020/12/2020-12-21/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Maximizing Profitability of Inventory with Mathematical Planning and Machine Learning in F# - Part 1","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/matthewcrews.com\/blog\/2020\/12\/2020-12-14\/"},"image":[{"@type":"ImageObject","url":"https:\/\/matthewcrews.com\/images\/Apple-Devices-Preview.png","width":3200,"height":2048}],"genre":"blog","wordcount":2848,"url":"https:\/\/matthewcrews.com\/blog\/2020\/12\/2020-12-14\/","datePublished":"2020-12-14T00:00:00+00:00","dateModified":"2023-05-23T09:34:35-07:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/matthewcrews.com\/images\/fast_fsharp_avatar.png"},"author":{"@type":"Person","name":"Matthew Crews"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Matthew Crews">Matthew Crews</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/blog/>Blog </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/matthewcrews/blog title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Matthew Crews">Matthew Crews</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/blog/ title>Blog</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/matthewcrews/blog title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">Maximizing Profitability of Inventory with Mathematical Planning and Machine Learning in F# - Part 1</h1><div class=content id=content><p>One of the questions that I love to answer is, &ldquo;What is the difference between Mathematical Planning and Machine Learning?&rdquo; This is an excellent question. The fields are close to one another and solutions often involve both techniques. The way I differentiate is based on what question they are meant to answer. Mathematical Planning is primarily concerned with answering the question, &ldquo;What should we do?&rdquo; Machine Learning answers the question, &ldquo;What is most likely?&rdquo; We often ask these questions at the same time which is why the techniques can become conflated.</p><p>I want to provide an example of a real-world problem that involves the marriage of these two techniques. Due to the amount of material to cover, I decided to break it into several posts. This first post will setup the problem, the Food Cart Packing Problem, and go over the tools we will use to evaluate the quality of different strategies. In the next post we will formulate a Mathematical Planning model to find a better strategy than the simple heuristic we start within this post. Finally, we will implement a Machine Learning model to make predictions on demand trends and feed that into the Mathematical Planning model for even more profitable strategies.</p><blockquote><p><strong>Note:</strong> To see all the code for this post, go <a href=https://github.com/matthewcrews/modelmondays/blob/main/ModelMonday/2020-12-14-FoodCartSeries/2020-12-14-Part1.fs target=_blank rel="noopener noreffer">here</a></p></blockquote><h2 id=the-food-cart-problem>The Food Cart Problem</h2><p>An example problem that I frequently use is the Food Cart Problem. It is easy for people to conceptualize so we can focus on the techniques. We are running a Food Cart and we want to know what items to pack at the beginning of the day to maximize our revenue. In this case we sell Burgers, Pizza, and Tacos (it&rsquo;s an eclectic food cart). Each food takes up a certain amount of pantry space, fridge space, and weight. Our food cart has recently been downsized so we must be purposeful about what we pack. We have kept track of how much we sell each day when we didn&rsquo;t used to run out of inventory.</p><p>We decide to start with a simple heuristic. On average, we sell 600 Burgers per day, 900 pizzas, and 700 tacos when we have excess inventory. Due to the downsize we are more restricted on space. We only have $3.0 m^3$ of storage, $2.0 m^3$ of fridge space, and can only carry $1,000 kg$ of weight. We have our same parking spot, so we expect to see the same demand.</p><p>Below is a breakdown of the space and weight requirements per serving of the food we provide.</p><table><thead><tr><th></th><th>Burger</th><th>Pizza</th><th>Taco</th><th>Available</th></tr></thead><tbody><tr><td>Storage Space</td><td>$700.0 cm^3$</td><td>$950.0 cm^3$</td><td>$800.0 cm^3$</td><td>$3.0 m^3$</td></tr><tr><td>Fridge Space</td><td>$900.0 cm^3$</td><td>$940.0 cm^3$</td><td>$850.0 cm^3$</td><td>$2.0 m^3$</td></tr><tr><td>Weight Capacity</td><td>$550.0 gm$</td><td>$800.0 gm$</td><td>$600.0 gm$</td><td>$1,000 kg$</td></tr></tbody></table><h2 id=a-simple-heuristic>A Simple Heuristic</h2><p>We decide to prioritize pizza because it makes the most money, then tacos, then burgers. We pack for 900 pizza orders because that&rsquo;s the average demand. With the remaining space, we pack tacos until we meet the average daily demand. If there is any room leftover, we will pack some burgers. Given the dimensions of our food, the result comes to 900 pizzas, 466 tacos, and 0 burgers. This makes sense to us since we have much less space than we did before, and we thought we may have to drop a food item from the menu. If we run the numbers, we expect to make $2,668.50 per day&mldr; or do we?</p><p>The important nuance to this problem is that this plan was made using the average demand. Half of the time the demand is higher, half of the time the demand is lower. On days where the demand for pizza is greater than 900, we would not be able to capture that additional revenue anymore because we do not have enough inventory. At the same time, when the demand for pizza is below 900, we lose out on the possibility we could have sold more of other foods had they been in stock. We would like to get some idea of what the actual revenue value we should expect. Fortunately there is a tool for this, <a href=https://en.wikipedia.org/wiki/Monte_Carlo_method target=_blank rel="noopener noreffer">Monte Carlo Simulation</a>.</p><h2 id=monte-carlo-simulation>Monte Carlo Simulation</h2><p>Monte Carlo simulation is conceptually simple, you can get an idea for the shape of a distribution (in our case expected revenue) by sampling from it many times and then computing descriptive statistics. Our hope is to find what the average revenue is expected to be.</p><blockquote><p><strong>Note</strong>: I encourage people to read up on Monte Carlo. I do not have the space here to provide an exhaustive explanation. To my Statistician readers, I know I am glossing over details. I am trying to provide an engaging example without intimidating readers with mathematical rigor.</p></blockquote><p>Now, if you can remember your course on probability distributions, you may remember that the arrival rate of customers can be modeled by a <a href=https://en.wikipedia.org/wiki/Poisson_distribution target=_blank rel="noopener noreffer">Poisson Distribution</a>. We will assume that this is a valid distribution to model the demand that we see at our food cart. Part of what makes this distribution easy to work with is that it takes a single parameter, $\lambda$. The $\lambda$ is easy to calculate, it is the mean of the data. Therefore, we say that pizza demand is a Poisson distribution with a $\lambda$ of 900.0 or in math notation:</p><p>$$\text{PizzaDemand} \sim Poisson(\lambda = 900 )$$</p><p>$\lambda$ can be thought of as the average rate of arrivals or in our case the overage number of orders in a day for a given food.</p><p>Now we need to do some domain modeling and setup our little simulation. We will start with some types to describe our domain.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>type</span> <span class=nc>Food</span> <span class=o>=</span> <span class=n>Food</span> <span class=k>of</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=k>type</span> <span class=nc>Lambda</span> <span class=o>=</span> <span class=n>Lambda</span> <span class=k>of</span> <span class=kt>float</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>Food</code> type differentiates between which food item we are referring to. The <code>Lambda</code> is the average demand we have observed and is the input for our Poisson distributions. We will use Units of Measure to track the units in our calculations. This will protect us from making silly conversion errors.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=o>[&lt;</span><span class=n>Measure</span><span class=o>&gt;]</span> <span class=k>type</span> <span class=nc>USD</span>
</span></span><span class=line><span class=cl><span class=o>[&lt;</span><span class=n>Measure</span><span class=o>&gt;]</span> <span class=k>type</span> <span class=nc>cm</span>
</span></span><span class=line><span class=cl><span class=o>[&lt;</span><span class=n>Measure</span><span class=o>&gt;]</span> <span class=k>type</span> <span class=nc>gm</span>
</span></span><span class=line><span class=cl><span class=o>[&lt;</span><span class=n>Measure</span><span class=o>&gt;]</span> <span class=k>type</span> <span class=nc>serving</span>
</span></span></code></pre></td></tr></table></div></div><p><code>USD</code> stands for United States Dollars. <code>cm</code> and <code>gm</code> are the SI units for volume and mass. The <code>serving</code> measure is for the quantity of servings we are packing. We will be using the <code>Math.NET</code> library for performing calculations with distributions. We need a function for taking a plan and generating a random outcome for our revenue model. We will call this function many, many times to get an idea of the distribution of revenue.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>sample</span> 
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>foodDemands</span><span class=o>:</span> <span class=n>seq</span><span class=o>&lt;</span><span class=n>Food</span> <span class=o>*</span> <span class=n>Lambda</span><span class=o>&gt;)</span>
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>revenue</span><span class=o>:</span> <span class=n>SMap</span><span class=o>&lt;</span><span class=n>Food</span><span class=o>,</span> <span class=kt>float</span><span class=o>&lt;</span><span class=n>USD</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;&gt;)</span>
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>plan</span><span class=o>:</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>Food</span><span class=o>,</span> <span class=kt>float</span><span class=o>&lt;</span><span class=n>serving</span><span class=o>&gt;&gt;)</span>
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>rng</span><span class=o>:</span> <span class=nn>System</span><span class=p>.</span><span class=n>Random</span><span class=o>)</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nv>evaluteSoldQuantity</span> <span class=n>planAmount</span> <span class=o>(</span><span class=n>Lambda</span> <span class=n>lambda</span><span class=o>)</span> <span class=n>rng</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Generate a random sample from the Poisson distribution and take the lesser
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// of the planned inventory or of the random Demand value that was generated
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>let</span> <span class=nv>actualQuantity</span> <span class=o>=</span> <span class=nn>Math</span><span class=p>.</span><span class=n>Min</span> <span class=o>(</span><span class=kt>float</span> <span class=n>planAmount</span><span class=o>,</span> <span class=nn>Sample</span><span class=p>.</span><span class=n>poisson</span> <span class=n>lambda</span> <span class=n>rng</span> <span class=o>|&gt;</span> <span class=kt>float</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Multiply by 1.0&lt;serving&gt; to get the correct units on the result
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>actualQuantity</span> <span class=o>*</span> <span class=mi>1</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>foodDemands</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>map</span> <span class=o>(</span><span class=k>fun</span> <span class=o>(</span><span class=n>food</span><span class=o>,</span> <span class=n>demandRate</span><span class=o>)</span> <span class=o>-&gt;</span> <span class=n>food</span><span class=o>,</span> <span class=o>(</span><span class=n>evaluteSoldQuantity</span> <span class=n>plan</span><span class=o>[</span><span class=n>food</span><span class=o>]</span> <span class=n>demandRate</span> <span class=n>rng</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>Seq</span><span class=p>.</span><span class=n>sumBy</span> <span class=o>(</span><span class=k>fun</span> <span class=o>(</span><span class=n>food</span><span class=o>,</span> <span class=n>soldQuantity</span><span class=o>)</span> <span class=o>-&gt;</span> <span class=n>soldQuantity</span> <span class=o>*</span> <span class=n>revenue</span><span class=o>[</span><span class=n>food</span><span class=o>])</span>
</span></span></code></pre></td></tr></table></div></div><p>What <code>sample</code> does is take the plan and perform a single simulation. It generates a random demand value for the given food and compares that to what we planned to have in inventory. It takes the lesser of our planned quantity or the random demand that was generated which becomes the actual amount sold. It takes the quantity of each food that was sold and multiplies it by the revenue of the food. It sums this across all the foods which gives us our revenue for that single simulation.</p><p><code>sample</code> performs a single simulation. We need to run many to calculate statistics on the results. We create an <code>evaluate</code> function which will call the <code>sample</code> function many times and gather the results. <code>evaluate</code> then computes the descriptive statistics and the revenues that were generated in our simulations.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>evalute</span> 
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>foodDemands</span><span class=o>:</span> <span class=n>seq</span><span class=o>&lt;</span><span class=n>Food</span> <span class=o>*</span> <span class=n>DemandRate</span><span class=o>&gt;)</span>
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>revenue</span><span class=o>:</span> <span class=n>SMap</span><span class=o>&lt;</span><span class=n>Food</span><span class=o>,</span> <span class=kt>float</span><span class=o>&lt;</span><span class=n>USD</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;&gt;)</span>
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>plan</span><span class=o>:</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>Food</span><span class=o>,</span> <span class=kt>float</span><span class=o>&lt;</span><span class=n>serving</span><span class=o>&gt;&gt;)</span>
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>rng</span><span class=o>:</span> <span class=nn>System</span><span class=p>.</span><span class=n>Random</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>numberSamples</span><span class=o>:</span> <span class=n>int</span><span class=o>)</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>let</span> <span class=nv>samples</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>seq</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=o>_</span> <span class=k>in</span> <span class=mi>1</span><span class=o>..</span><span class=n>numberSamples</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>                <span class=n>sample</span> <span class=n>foodDemands</span> <span class=n>revenue</span> <span class=n>plan</span> <span class=n>rng</span>
</span></span><span class=line><span class=cl>                <span class=o>|&gt;</span> <span class=kt>float</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=o>|&gt;</span> <span class=nn>Array</span><span class=p>.</span><span class=n>ofSeq</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>DescriptiveStatistics</span> <span class=n>samples</span>
</span></span></code></pre></td></tr></table></div></div><p>We provide an argument to <code>evaluate</code> called <code>numberSamples</code> which controls the number of simulations that we perform. <code>DescriptiveStatistics</code> from <code>Math.NET</code> allows us to compute the descriptive statistics. This provides us with the sample mean, variance, and standard deviation.</p><h2 id=evaluating-our-simple-heuristic>Evaluating Our Simple Heuristic</h2><p>Now that we have the ability to simulate the effects of different plans on our revenue, let’s see how well our simple heuristic does. First, we define the data for the parameters of our model.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>burger</span> <span class=o>=</span> <span class=n>Food</span> <span class=s>&#34;Burger&#34;</span>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>pizza</span> <span class=o>=</span> <span class=n>Food</span> <span class=s>&#34;Pizza&#34;</span>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>taco</span> <span class=o>=</span> <span class=n>Food</span> <span class=s>&#34;Taco&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>foods</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=n>burger</span>
</span></span><span class=line><span class=cl>        <span class=n>pizza</span>
</span></span><span class=line><span class=cl>        <span class=n>taco</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>revenue</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>    <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=n>burger</span><span class=o>,</span> <span class=mi>1</span><span class=o>.</span><span class=mi>3</span><span class=o>&lt;</span><span class=n>USD</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>pizza</span><span class=o>,</span>  <span class=mi>1</span><span class=o>.</span><span class=mi>6</span><span class=o>&lt;</span><span class=n>USD</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>taco</span><span class=o>,</span>   <span class=mi>1</span><span class=o>.</span><span class=mi>4</span><span class=o>&lt;</span><span class=n>USD</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span> <span class=o>|&gt;</span> <span class=n>SMap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>storage</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=n>burger</span><span class=o>,</span> <span class=mi>700</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>cm</span><span class=o>^</span><span class=mi>3</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>pizza</span><span class=o>,</span>  <span class=mi>950</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>cm</span><span class=o>^</span><span class=mi>3</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>taco</span><span class=o>,</span>   <span class=mi>800</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>cm</span><span class=o>^</span><span class=mi>3</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span> <span class=o>|&gt;</span> <span class=n>SMap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>fridgeSpace</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=n>burger</span><span class=o>,</span> <span class=mi>900</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>cm</span><span class=o>^</span><span class=mi>3</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>pizza</span><span class=o>,</span>  <span class=mi>940</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>cm</span><span class=o>^</span><span class=mi>3</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>taco</span><span class=o>,</span>   <span class=mi>850</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>cm</span><span class=o>^</span><span class=mi>3</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span> <span class=o>|&gt;</span> <span class=n>SMap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>weight</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=n>burger</span><span class=o>,</span> <span class=mi>550</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>gm</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>pizza</span><span class=o>,</span>  <span class=mi>800</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>gm</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>taco</span><span class=o>,</span>   <span class=mi>600</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>gm</span><span class=o>/</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span> <span class=o>|&gt;</span> <span class=n>SMap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>demandRates</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=n>burger</span><span class=o>,</span> <span class=n>DemandRate</span> <span class=mi>600</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>pizza</span><span class=o>,</span>  <span class=n>DemandRate</span> <span class=mi>900</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>taco</span><span class=o>,</span>   <span class=n>DemandRate</span> <span class=mi>700</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>maxItems</span> <span class=o>=</span> <span class=mi>1_000</span>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>maxWeight</span> <span class=o>=</span> <span class=mi>1_000_000</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>gm</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>maxStorage</span> <span class=o>=</span> <span class=mi>3_000_000</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>cm</span><span class=o>^</span><span class=mi>3</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>maxFridge</span> <span class=o>=</span> <span class=mi>2_000_000</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>cm</span><span class=o>^</span><span class=mi>3</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>We then define some functions which implement our simple heuristic for prioritizing pizza, then tacos, then burgers.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=c1>// A function to call Math.Floor on floats with Units of Measure
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>let</span> <span class=nv>floor</span> <span class=o>(</span><span class=n>x</span><span class=o>:</span> <span class=kt>float</span><span class=o>&lt;</span><span class=k>&#39;</span><span class=n>Measure</span><span class=o>&gt;)</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=nn>Math</span><span class=p>.</span><span class=n>Floor</span> <span class=o>(</span><span class=kt>float</span> <span class=n>x</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>FSharp</span><span class=p>.</span><span class=nn>Core</span><span class=p>.</span><span class=nn>LanguagePrimitives</span><span class=p>.</span><span class=n>FloatWithMeasure</span><span class=o>&lt;</span><span class=k>&#39;</span><span class=n>Measure</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// A function to call Math.Min on floats with Units of Measure
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>let</span> <span class=nv>min</span> <span class=o>(</span><span class=n>a</span><span class=o>:</span> <span class=kt>float</span><span class=o>&lt;</span><span class=k>&#39;</span><span class=n>Measure</span><span class=o>&gt;,</span> <span class=n>b</span><span class=o>:</span> <span class=kt>float</span><span class=o>&lt;</span><span class=k>&#39;</span><span class=n>Measure</span><span class=o>&gt;)</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=nn>Math</span><span class=p>.</span><span class=n>Min</span> <span class=o>(</span><span class=kt>float</span> <span class=n>a</span><span class=o>,</span> <span class=kt>float</span> <span class=n>b</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nn>FSharp</span><span class=p>.</span><span class=nn>Core</span><span class=p>.</span><span class=nn>LanguagePrimitives</span><span class=p>.</span><span class=n>FloatWithMeasure</span><span class=o>&lt;</span><span class=k>&#39;</span><span class=n>Measure</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// We packe the average daily demand of pizzas
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>let</span> <span class=nv>pizzaQuantity</span> <span class=o>=</span> <span class=mi>900</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>serving</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>tacoQuantity</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=c1>// The number of possible tacos based on space
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>let</span> <span class=nv>tacosBasedOnSpace</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=nn>List</span><span class=p>.</span><span class=n>min</span> <span class=o>[</span>
</span></span><span class=line><span class=cl>            <span class=o>(</span><span class=n>maxStorage</span> <span class=o>-</span> <span class=o>(</span><span class=n>pizzaQuantity</span> <span class=o>*</span> <span class=n>storage</span><span class=o>[</span><span class=n>pizza</span><span class=o>]))</span> <span class=o>/</span> <span class=n>storage</span><span class=o>.[</span><span class=n>taco</span><span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>(</span><span class=n>maxFridge</span> <span class=o>-</span> <span class=o>(</span><span class=n>pizzaQuantity</span> <span class=o>*</span> <span class=n>fridgeSpace</span><span class=o>[</span><span class=n>pizza</span><span class=o>]))</span> <span class=o>/</span> <span class=n>fridgeSpace</span><span class=o>.[</span><span class=n>taco</span><span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>(</span><span class=n>maxWeight</span> <span class=o>-</span> <span class=o>(</span><span class=n>pizzaQuantity</span> <span class=o>*</span> <span class=n>weight</span><span class=o>[</span><span class=n>pizza</span><span class=o>]))</span> <span class=o>/</span> <span class=n>weight</span><span class=o>.[</span><span class=n>taco</span><span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span> <span class=o>|&gt;</span> <span class=n>floor</span>
</span></span><span class=line><span class=cl>    <span class=c1>// The min of taco demand and the space available
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>min</span> <span class=o>(</span><span class=mi>700</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>serving</span><span class=o>&gt;,</span> <span class=n>tacosBasedOnSpace</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>burgerQuantity</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=c1>// The number of possible burgers based on space
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>let</span> <span class=nv>burgersBasedOnSpace</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=nn>List</span><span class=p>.</span><span class=n>min</span> <span class=o>[</span>
</span></span><span class=line><span class=cl>            <span class=o>(</span><span class=n>maxStorage</span> <span class=o>-</span> <span class=o>(</span><span class=n>pizzaQuantity</span> <span class=o>*</span> <span class=n>storage</span><span class=o>[</span><span class=n>pizza</span><span class=o>])</span> <span class=o>-</span> <span class=o>(</span><span class=n>tacoQuantity</span> <span class=o>*</span> <span class=n>storage</span><span class=o>[</span><span class=n>taco</span><span class=o>]))</span> <span class=o>/</span> <span class=n>storage</span><span class=o>[</span><span class=n>taco</span><span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>(</span><span class=n>maxFridge</span> <span class=o>-</span> <span class=o>(</span><span class=n>pizzaQuantity</span> <span class=o>*</span> <span class=n>fridgeSpace</span><span class=o>[</span><span class=n>pizza</span><span class=o>])</span> <span class=o>-</span> <span class=o>(</span><span class=n>tacoQuantity</span> <span class=o>*</span> <span class=n>fridgeSpace</span><span class=o>[</span><span class=n>taco</span><span class=o>]))</span> <span class=o>/</span> <span class=n>fridgeSpace</span><span class=o>[</span><span class=n>taco</span><span class=o>]</span>
</span></span><span class=line><span class=cl>            <span class=o>(</span><span class=n>maxWeight</span> <span class=o>-</span> <span class=o>(</span><span class=n>pizzaQuantity</span> <span class=o>*</span> <span class=n>weight</span><span class=o>[</span><span class=n>pizza</span><span class=o>])</span> <span class=o>-</span> <span class=o>(</span><span class=n>tacoQuantity</span> <span class=o>*</span> <span class=n>weight</span><span class=o>[</span><span class=n>taco</span><span class=o>]))</span> <span class=o>/</span> <span class=n>weight</span><span class=o>[</span><span class=n>taco</span><span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span> <span class=o>|&gt;</span> <span class=n>floor</span>
</span></span><span class=line><span class=cl>    <span class=c1>// The min of burgers demand and the space available
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>min</span> <span class=o>(</span><span class=mi>600</span><span class=o>.</span><span class=mi>0</span><span class=o>&lt;</span><span class=n>serving</span><span class=o>&gt;,</span> <span class=n>burgersBasedOnSpace</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>plan</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=n>burger</span><span class=o>,</span> <span class=n>burgerQuantity</span>
</span></span><span class=line><span class=cl>        <span class=n>pizza</span><span class=o>,</span> <span class=n>pizzaQuantity</span>
</span></span><span class=line><span class=cl>        <span class=n>taco</span><span class=o>,</span> <span class=n>tacoQuantity</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span> <span class=o>|&gt;</span> <span class=n>Map</span>
</span></span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s analyze the result of performing 100 simulations and analyze the distribution of the revenue.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fsharp data-lang=fsharp><span class=line><span class=cl><span class=k>let</span> <span class=nv>rng</span> <span class=o>=</span> <span class=nn>System</span><span class=p>.</span><span class=n>Random</span> <span class=bp>()</span>
</span></span><span class=line><span class=cl><span class=k>let</span> <span class=nv>stats_100Runs</span> <span class=o>=</span> <span class=nn>Simulation</span><span class=p>.</span><span class=n>evalute</span> <span class=n>demandRates</span> <span class=n>revenue</span> <span class=n>plan</span> <span class=n>rng</span> <span class=mi>100</span>
</span></span></code></pre></td></tr></table></div></div><p>I like to print things out in tables, and I am loving the <code>Spectre.Console</code> <a href=https://github.com/spectresystems/spectre.console target=_blank rel="noopener noreffer">project</a>. Here is a table with the results of our simulations.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>┌──────────────┬─────────┬──────────┬────────┐
</span></span></span><span class=line><span class=cl><span class=go>│ NumberOfRuns │ Mean    │ Variance │ StdDev │
</span></span></span><span class=line><span class=cl><span class=go>├──────────────┼─────────┼──────────┼────────┤
</span></span></span><span class=line><span class=cl><span class=go>│ 100          │ 2075.50 │ 605.37   │ 24.60  │
</span></span></span><span class=line><span class=cl><span class=go>└──────────────┴─────────┴──────────┴────────┘
</span></span></span></code></pre></td></tr></table></div></div><p>Now we need to ask a critical question, &ldquo;How confident are we in the answer?&rdquo; Our initial run shows that on average, we appear to make $2,075.50. What happens if we run this experiment again?</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>┌──────────────┬─────────┬──────────┬────────┐
</span></span></span><span class=line><span class=cl><span class=go>│ NumberOfRuns │ Mean    │ Variance │ StdDev │
</span></span></span><span class=line><span class=cl><span class=go>├──────────────┼─────────┼──────────┼────────┤
</span></span></span><span class=line><span class=cl><span class=go>│ 100          │ 2071.54 │ 926.30   │ 30.44  │
</span></span></span><span class=line><span class=cl><span class=go>└──────────────┴─────────┴──────────┴────────┘
</span></span></span></code></pre></td></tr></table></div></div><p>We get a slightly different answer, \$2,071.54. Well, this is interesting. Our numbers are making sense based on our earlier thought experiment. We are no longer carrying extra inventory, so we do not benefit from days where demand is exceptionally high. We would have to have excessive demand for pizza and tacos to sell everything and achieve a revenue of \$2,668.50.</p><p>What we need to focus on answering now is how well do we know the Mean, the expected revenue. Fortunately, there is a useful statistical tool called the <a href=https://en.wikipedia.org/wiki/Confidence_interval target=_blank rel="noopener noreffer">Confidence Interval</a>. It allows us to put bounds on where we think the true expected revenue is. The formula for the Confidence Interval is:</p><p>$$
CI = \bar{x} \pm z \frac{s}{\sqrt{n}}
$$</p><p>The Confidence Interval ($CI$) is defined as a lower and upper bound. $\bar{x}$ is the average of the data, $s$ is the standard deviation, and $n$ is the number of samples that were taken. $z$ is a parameter you choose based on how confident you want to be that the true mean of the distribution is between the lower and upper bound. If we want to be 95% confident that the true average revenue is between the lower and upper bound, we will use a $z$ of 1.960. If we wanted to be 99% percent sure, we would use a $z$ of 2.567. If you would like to know where the values of $z$ are coming from, look up the t-distribution and t-distribution Confidence Intervals.</p><blockquote><p><strong>Note:</strong> For my stats friends. I am assuming that the error is normally distributed and has a mean of 0. Normally I would plot this to verify but the blog series is already turning into 3 posts, so I have to cut some details somewhere.</p></blockquote><p>Let&rsquo;s add the confidence interval for 95% and 99% to our output table and see what we get.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>┌──────────────┬─────────┬──────────┬────────┬──────────────────┬──────────────────┐
</span></span></span><span class=line><span class=cl><span class=go>│ NumberOfRuns │ Mean    │ Variance │ StdDev │ 95% CI           │ 99% CI           │
</span></span></span><span class=line><span class=cl><span class=go>├──────────────┼─────────┼──────────┼────────┼──────────────────┼──────────────────┤
</span></span></span><span class=line><span class=cl><span class=go>│ 100          │ 2064.35 │ 997.13   │ 31.58  │ 2058.16, 2070.54 │ 2056.25, 2072.46 │
</span></span></span><span class=line><span class=cl><span class=go>└──────────────┴─────────┴──────────┴────────┴──────────────────┴──────────────────┘
</span></span></span></code></pre></td></tr></table></div></div><p>This gives us a much clearer understanding of what we can expect out of our revenue. This is how we should interpret these Confidence Intervals. There is a 95% probability that the true average revenue is between 2058.16 and 2070.54. There is a 99% probability that the true average revenue is between 2056.25 and 2072.46. Notice that the bounds of the 99% CI are wider than the 95% CI. The more confident we want to be that we have captured the true average revenue, the wider we must make the bounds.</p><p>The average revenue of 2064.35 we observed in this most recent run is only the average of the data we simulated. It is more valuable to understand where the true revenue average actually is. Let&rsquo;s increase the number of simulations that we perform and see how that affects the Confidence Intervals.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>┌──────────────┬─────────┬──────────┬────────┬──────────────────┬──────────────────┐
</span></span></span><span class=line><span class=cl><span class=go>│ NumberOfRuns │ Mean    │ Variance │ StdDev │ 95% CI           │ 99% CI           │
</span></span></span><span class=line><span class=cl><span class=go>├──────────────┼─────────┼──────────┼────────┼──────────────────┼──────────────────┤
</span></span></span><span class=line><span class=cl><span class=go>│ 100          │ 2073.74 │ 735.74   │ 27.12  │ 2068.43, 2079.06 │ 2066.78, 2080.71 │
</span></span></span><span class=line><span class=cl><span class=go>│ 1,000        │ 2071.96 │ 895.10   │ 29.92  │ 2070.11, 2073.81 │ 2069.53, 2074.39 │
</span></span></span><span class=line><span class=cl><span class=go>│ 10,000       │ 2073.31 │ 776.40   │ 27.86  │ 2072.77, 2073.86 │ 2072.60, 2074.03 │
</span></span></span><span class=line><span class=cl><span class=go>│ 100,000      │ 2073.34 │ 773.98   │ 27.82  │ 2073.16, 2073.51 │ 2073.11, 2073.56 │
</span></span></span><span class=line><span class=cl><span class=go>│ 1,000,000    │ 2073.20 │ 778.17   │ 27.90  │ 2073.14, 2073.25 │ 2073.13, 2073.27 │
</span></span></span><span class=line><span class=cl><span class=go>└──────────────┴─────────┴──────────┴────────┴──────────────────┴──────────────────┘
</span></span></span></code></pre></td></tr></table></div></div><p>We see that the mean, variance, and standard deviation are not changing significantly as we increase the number of simulations. What we do see though is that the Confidence Intervals are getting tighter. This is because as we gather more data, we become more confident of where the true average revenue is. We can see that by the time we get to 1,000,000 samples the CI for 95% is only 0.011 wide.</p><p>Our model for revenue does not have many random variables so it shouldn&rsquo;t surprise us that it is easy to get a tight bound on the CIs. As models becomes larger with more random variables though, the number of iterations to achieve tight bound goes up significantly. There is a cost trade off. The tighter you want the bounds, the more computational effort that is required.</p><h2 id=next-steps>Next Steps</h2><p>We&rsquo;ve covered quite a bit of ground in this post. We have introduced a new problem, the Food Cart Problem. We formulated a simple simulation which allows us to perform some statistical experiments to understand how good our simple heuristic is for packing the Food Cart. We also introduced the idea of a Confidence Interval for understanding how good our estimates are. Next time we will show how to use Mathematical Planning to find a better plan for packing the Food Cart that achieves a higher expected revenue which is also more reliable.</p></div><div id=comments></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.112.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=matthewcrews.com target=_blank>Matthew Crews</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"PASDMWALPK",algoliaIndex:"index.en",algoliaSearchKey:"b42948e51daaa93df92381c8e2ac0f93",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>